<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#2563eb">
    <title>PSE1/PSE2 - RÃ©visions Secourisme</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                ğŸš‘ <span>United hatzalah RÃ©visionsss</span>
            </div>
            <div class="header-actions">
                <button class="btn-icon" id="quickReviewBtn" aria-label="RÃ©vision rapide" title="RÃ©vision rapide">âš¡</button>
                <button class="btn-icon" id="fontSizeBtn" aria-label="Personnalisation" title="Personnalisation">A</button>
                <button class="btn-icon desktop-only" id="flashcardsHeaderBtn" aria-label="Flashcards" title="Flashcards">ğŸ´</button>
                <button class="btn-icon desktop-only" id="progressHeaderBtn" aria-label="Progression" title="Progression">ğŸ“Š</button>
                <button class="btn-icon" id="searchBtn" aria-label="Rechercher">ğŸ”</button>
                <button class="btn-icon" id="themeBtn" aria-label="Changer thÃ¨me">ğŸŒ™</button>
                <button class="btn-icon" id="menuBtn" aria-label="Menu">â˜°</button>
            </div>
        </div>
    </header>

    <!-- Barre de recherche -->
    <div class="search-bar" id="searchBar">
        <input type="search" class="search-input" id="searchInput" placeholder="Rechercher... (ex: valve mitrale)" autocomplete="off">
        <div class="search-results" id="searchResults"></div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="nav-section">
            <div class="nav-section-title">ğŸ“š Contenu</div>
            <div class="nav-item" data-section="intro">ğŸ“Œ Introduction</div>
            <div class="nav-item" data-section="biologie">ğŸ§¬ Biologie de base</div>
            
            <div class="nav-item" data-section="nerveux">ğŸ§  SystÃ¨me nerveux</div>
            <div class="nav-sub-item" data-section="nerveux-cerveau">Le cerveau</div>
            <div class="nav-sub-item" data-section="nerveux-snc">SNC (cerveau/moelle)</div>
            <div class="nav-sub-item" data-section="nerveux-snp">SNP (somatique/autonome)</div>
            <div class="nav-sub-item" data-section="nerveux-nerfs">Nerfs et transmission</div>
            
            <div class="nav-item" data-section="respiratoire">ğŸ« SystÃ¨me respiratoire</div>
            <div class="nav-sub-item" data-section="respiratoire-anatomie">Anatomie</div>
            <div class="nav-sub-item" data-section="respiratoire-echanges">Ã‰changes gazeux</div>
            
            <div class="nav-item" data-section="cardio">ğŸ«€ SystÃ¨me cardio-vasculaire</div>
            <div class="nav-sub-item" data-section="cardio-coeur">Le cÅ“ur</div>
            <div class="nav-sub-item" data-section="cardio-vaisseaux">Vaisseaux sanguins</div>
            <div class="nav-sub-item" data-section="cardio-sang">Le sang</div>
        </div>
    </nav>
    <div class="sidebar-tab" id="sidebarTab">ğŸ“š MENU</div>

    <!-- Contenu principal -->
    <main class="main-content" id="mainContent">
        <div class="breadcrumb" id="breadcrumb">
            <span>ğŸ  Accueil</span>
        </div>
        
        <div id="contentArea">
            <!-- Le contenu sera injectÃ© ici -->
        </div>
    </main>

    <!-- Bouton retour en haut -->
    <button class="scroll-top" id="scrollTop" aria-label="Retour en haut">â†‘</button>

    <!-- Bottom Navigation (mobile) -->
    <nav class="bottom-nav">
        <button class="bottom-nav-item active" id="navHome">
            <span class="bottom-nav-icon">ğŸ </span>
            <span>Accueil</span>
        </button>
        <button class="bottom-nav-item" id="navSearch">
            <span class="bottom-nav-icon">ğŸ”</span>
            <span>Recherche</span>
        </button>
        <button class="bottom-nav-item" id="navMenu">
            <span class="bottom-nav-icon">ğŸ“š</span>
            <span>Sections</span>
        </button>
        <button class="bottom-nav-item" id="navFlashcards">
            <span class="bottom-nav-icon">ğŸ´</span>
            <span>Flashcards</span>
        </button>
        <button class="bottom-nav-item" id="navProgress">
            <span class="bottom-nav-icon">ğŸ“Š</span>
            <span>Progression</span>
        </button>
    </nav>

    <!-- Install prompt -->
    <div class="install-prompt" id="installPrompt">
        <span>ğŸ“² Installer l'app pour un accÃ¨s hors-ligne ?</span>
        <button class="install-btn" id="installBtn">Installer</button>
    </div>

    <!-- Lightbox pour images -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" id="lightboxClose">âœ•</button>
        <img id="lightboxImg" src="" alt="">
    </div>

    <!-- SECTION FLASHCARDS - structurÃ©e avec .flashcard-new-* mais compatible JS existant -->
    <div id="flashcards-section" style="display: none;">
        <div class="flashcard-new-container">
            
            <!-- Header avec bouton fermer -->
            <div class="flashcard-new-header">
                <h2>ğŸ´ Flashcards</h2>
                <button type="button" class="btn-close-flashcards" onclick="hideFlashcardsSection()">âœ•</button>
            </div>

            <!-- Filtres par section -->
            <div style="display: flex; gap: 8px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 10px;">
                <button onclick="filterCards('all')" id="filter-all" class="fc-filter-btn" style="padding: 8px 16px; background: var(--primary); color: white; border: none; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    Toutes
                </button>
                <button onclick="filterCards('intro')" id="filter-intro" class="fc-filter-btn" style="padding: 8px 16px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    Intro
                </button>
                <button onclick="filterCards('nerveux')" id="filter-nerveux" class="fc-filter-btn" style="padding: 8px 16px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    Nerveux
                </button>
                <button onclick="filterCards('respiratoire')" id="filter-respiratoire" class="fc-filter-btn" style="padding: 8px 16px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    Respiratoire
                </button>
                <button onclick="filterCards('cardio')" id="filter-cardio" class="fc-filter-btn" style="padding: 8px 16px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    Cardio
                </button>
            </div>

            <!-- Compteur -->
            <div id="fc-counter" class="flashcard-new-counter">
                1 / 30
            </div>

            <!-- Barre de progression -->
            <div class="flashcard-new-progress">
                <div id="fc-progress" class="flashcard-new-progress-fill"></div>
            </div>

            <!-- Carte (sans 3D, gÃ©rÃ©e via JS en affichant/cachant les faces) -->
            <div id="fc-card-wrapper" class="flashcard-new-wrapper">
                <div id="fc-card" class="flashcard-new">
                    
                    <!-- FACE AVANT (Question) -->
                    <div id="fc-front" class="flashcard-new-face flashcard-new-question">
                        <div>
                            <div class="flashcard-new-label">
                                QUESTION
                            </div>
                            <div id="fc-question" class="flashcard-new-text">
                                <!-- Question -->
                            </div>
                        </div>
                        <button type="button" class="flashcard-new-btn-flip" onclick="flipCard()">
                            ğŸ‘ï¸ Voir la rÃ©ponse
                        </button>
                    </div>

                    <!-- FACE ARRIÃˆRE (RÃ©ponse) -->
                    <div id="fc-back" class="flashcard-new-face flashcard-new-answer">
                        <div>
                            <div class="flashcard-new-label">
                                RÃ‰PONSE
                            </div>
                            <div id="fc-answer" class="flashcard-new-text">
                                <!-- RÃ©ponse -->
                            </div>
                        </div>
                        <div class="flashcard-new-actions">
                            <button type="button" class="flashcard-new-btn flashcard-new-btn-hard" onclick="rate(3)">
                                ğŸ˜«
                                <span>Difficile</span>
                            </button>
                            <button type="button" class="flashcard-new-btn flashcard-new-btn-medium" onclick="rate(2)">
                                ğŸ˜
                                <span>Moyen</span>
                            </button>
                            <button type="button" class="flashcard-new-btn flashcard-new-btn-easy" onclick="rate(1)">
                                ğŸ˜Š
                                <span>Facile</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation : PrÃ©cÃ©dent / Passer / Suivant -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                <button type="button" onclick="previousCard()" style="padding: 12px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer;">
                    â† PrÃ©cÃ©dent
                </button>
                <button type="button" onclick="skipCard()" style="padding: 12px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer;">
                    Passer â†’
                </button>
                <button type="button" onclick="nextCard()" style="padding: 12px; background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer;">
                    Suivant â†’
                </button>
            </div>

            <!-- Stats -->
            <div class="flashcard-new-stats">
                <div class="flashcard-new-stat">
                    <div class="flashcard-new-stat-icon">ğŸ˜Š</div>
                    <div id="fc-stat-easy" class="flashcard-new-stat-value">0</div>
                </div>
                <div class="flashcard-new-stat">
                    <div class="flashcard-new-stat-icon">ğŸ˜</div>
                    <div id="fc-stat-medium" class="flashcard-new-stat-value">0</div>
                </div>
                <div class="flashcard-new-stat">
                    <div class="flashcard-new-stat-icon">ğŸ˜«</div>
                    <div id="fc-stat-hard" class="flashcard-new-stat-value">0</div>
                </div>
            </div>

            <!-- Bouton mÃ©langer -->
            <button
                type="button"
                class="flashcard-new-btn-shuffle"
                onclick="shuffle()">
                ğŸ”€ MÃ©langer les cartes
            </button>

        </div>
    </div>
    <!-- Modal Progression -->
    <div class="modal" id="progressModal">
        <div class="modal-overlay" id="progressOverlay"></div>
        <div class="modal-content progress-container">
            <button class="modal-close" id="closeProgress">âœ•</button>
            
            <div class="progress-header">
                <h2>ğŸ“Š Ma Progression</h2>
                <div class="progress-percentage" id="progressPercentage">0%</div>
            </div>

            <div class="progress-bar-large">
                <div class="progress-bar-fill" id="progressBarLarge"></div>
            </div>

            <div class="progress-stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“š</div>
                    <div class="stat-info">
                        <span class="stat-number" id="sectionsRead">0</span>
                        <span class="stat-label">Sections lues</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â±ï¸</div>
                    <div class="stat-info">
                        <span class="stat-number" id="timeSpent">0 min</span>
                        <span class="stat-label">Temps de rÃ©vision</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¯</div>
                    <div class="stat-info">
                        <span class="stat-number" id="streakDays">0</span>
                        <span class="stat-label">Jours consÃ©cutifs</span>
                    </div>
                </div>
            </div>

            <div class="progress-actions">
                <button class="btn-primary" id="markAllRead">âœ“ Tout marquer comme lu</button>
                <button class="btn-danger" id="resetProgress">ğŸ”„ RÃ©initialiser</button>
            </div>

            <div class="sections-checklist">
                <h3>Sections</h3>
                <div id="sectionsChecklistContent"></div>
            </div>
        </div>
    </div>

    <!-- Modal RÃ©vision Rapide -->
    <div class="modal" id="quickReviewModal">
        <div class="modal-overlay" id="quickReviewOverlay"></div>
        <div class="modal-content quick-review-container">
            <button class="modal-close" id="closeQuickReview">âœ•</button>
            
            <div class="quick-review-header">
                <h2>âš¡ RÃ©vision Rapide</h2>
                <p>Points critiques Ã  retenir</p>
            </div>

            <div class="quick-review-actions">
                <button class="btn-secondary" id="printReview">ğŸ–¨ï¸ Imprimer</button>
                <button class="btn-secondary" id="copyReview">ğŸ“‹ Copier</button>
            </div>

            <div id="quickReviewContent"></div>
        </div>
    </div>

    <!-- Modal Personnalisation -->
    <div class="modal" id="customizeModal">
        <div class="modal-overlay" id="customizeOverlay"></div>
        <div class="modal-content customize-container">
            <button class="modal-close" id="closeCustomize">âœ•</button>
            
            <h2>ğŸ¨ Personnalisation</h2>

            <div class="customize-section">
                <h3>Taille de police</h3>
                <div class="font-size-controls">
                    <button class="btn-secondary" id="fontSizeDecrease">A-</button>
                    <span id="fontSizeDisplay">16px</span>
                    <button class="btn-secondary" id="fontSizeIncrease">A+</button>
                </div>
            </div>

            <div class="customize-section">
                <h3>Couleur d'accentuation</h3>
                <div class="color-picker">
                    <button class="color-option active" data-color="#2563eb" style="background: #2563eb" title="Bleu"></button>
                    <button class="color-option" data-color="#10b981" style="background: #10b981" title="Vert"></button>
                    <button class="color-option" data-color="#8b5cf6" style="background: #8b5cf6" title="Violet"></button>
                    <button class="color-option" data-color="#f59e0b" style="background: #f59e0b" title="Orange"></button>
                    <button class="color-option" data-color="#ec4899" style="background: #ec4899" title="Rose"></button>
                </div>
            </div>

            <div class="customize-section">
                <h3>AccessibilitÃ©</h3>
                <label class="toggle-switch">
                    <input type="checkbox" id="dyslexicModeToggle">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Police dyslexie-friendly</span>
                </label>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>